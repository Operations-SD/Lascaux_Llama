@page "/Spin_URL"
@inject NnetDbContext db
@inject NavigationManager _nav
@inject IConfiguration _configuration
@* @inject NounService nounService *@
@layout CustomLayout
@using IntelChat.Models
@using System.Data.SqlClient;
@using System.Data;
@using System.Data.Common;
@* @using IntelChat.Services; *@

<style>
	body {
		background: url("https://agineuralnet.blob.core.windows.net/background/BG_Language.png")no-repeat; /*Background to blob*/
		background-size: cover;
		<!--background: left 0px top 0px;-->
		background-color: #000000;
		color: antiquewhite;
		opacity: 70%;
		<!--width: 1920px;
		height: 1080px;-->
	}

    /* Full viewport centering */
    html, body {
        height: 100%;
        margin: 0;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .container {
        display: inline-block;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: left;
        width: 100%;
        width: 850px;
        height: 700px;
        padding: 20px;
        background-color: grey;
        background-size: cover;
        border-radius: 12px;
        opacity: 95%;
    }

    .banner {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: #f9f9f9;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #ddd;
        width: 100%;
        margin-bottom: 20px;
    }

    .entity-info {
        width: 100%;
        flex-direction: column;
        align-items: center;
        color: #000000;
    }

    .info-line {
        display: flex;
        gap: 20px;
        justify-content: center;
        width: 100%;
    }

    .media-section {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
    }

    .scaled-image {
        width: 200px;
        height: 200px;
        object-fit: inherit;
        border-radius: 8px;
    }

    .scaled-content {
        width: 600px;
        height: 400px;
        border-radius: 8px;
    }

    .navigation {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 300px;
    }

    button {
        padding: 10px 15px;
        font-size: 16px;
        cursor: pointer;
        border: none;
        background: #007bff;
        color: white;
        border-radius: 5px;
    }
</style>


@if (SelectedUrl != null)
 {
   
    <div class="container">

        <!-- Entity Banner -->
        <div class="banner">
            <div class="entity-info">
                <!-- Line 1: ID, Label, Description -->
                <div class="info-line">
                    <p><strong>ID:</strong> @SelectedUrl.UrlId</p>
                    <p><strong>Label:</strong> @SelectedUrl.UrlLabel</p>
                    <p><strong>Description:</strong> @SelectedUrl.UrlDescription</p>
                </div>

                <!-- Line 2: Type, Tag -->
                <div class="info-line">
                    <p><strong>Type:</strong> @SelectedUrl.UrlType</p>
                    <p><strong>Tag:</strong> @SelectedUrl.UrlTag</p>
                </div>

                <!-- Line 3: URL -->
                <div class="info-line">
                    <p><strong>URL:</strong> <a href="@SelectedUrl.UrlCloud" target="_blank">@SelectedUrl.UrlCloud</a></p>
                </div>
            </div>
        </div>

        <!-- Media Display -->
        <div class="media-section">
            @if (GetUrlCategory(SelectedUrl.UrlCloud) == "Image")
            {
                <img src="@SelectedUrl.UrlCloud" alt="Embedded Image"
                     style="max-width: 300px; max-height: 500px; width: auto; height: auto;">
            }
            else if (GetUrlCategory(SelectedUrl.UrlCloud) == "YouTube Video" || GetUrlCategory(SelectedUrl.UrlCloud) == "Vimeo Video")
            {
                <iframe width="560" height="315" src="@GetEmbeddedUrl(SelectedUrl.UrlCloud)" frameborder="0" allowfullscreen></iframe>
            }
            else if (GetUrlCategory(SelectedUrl.UrlCloud) == "Video File")
            {
                <video width="100%" height="auto" controls>
                    <source src="@GetEmbeddedUrl(SelectedUrl.UrlCloud)" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            }
            else if (GetUrlCategory(SelectedUrl.UrlCloud) == "Audio File")
            {
                <audio controls>
                    <source src="@GetEmbeddedUrl(SelectedUrl.UrlCloud)" type="audio/mpeg">
                    Your browser does not support the audio tag.
                </audio>
            }
            else if (GetUrlCategory(SelectedUrl.UrlCloud) == "Document")
            {
                <iframe src="@GetEmbeddedUrl(SelectedUrl.UrlCloud)" width="100%" height="600px"></iframe>
            }
            else
            {
                <a href="@SelectedUrl.UrlCloud" target="_blank">Open Link</a>
            }
        </div>

        <button class="general-menu-button" @onclick="@(()=>_nav.NavigateTo("/URL?pod="+pod+"&pid="+pid))"
                style="position:absolute;left:00px;top:10px;height:60px;border:0px;width:140px;opacity:100%;color:darkred;">
            URL
        </button>

        <button class="general-menu-button" @onclick="GoToPreviousUrl"
                style="position:absolute;left:40px;top:650px;height:60px;border:0px;width:140px;color:#000000;opacity:100%;">
            Previous
        </button>

        <button class="general-menu-button" @onclick="GoToNextUrl"
                style="position:absolute;left:200px;top:650px;height:60px;border:0px;width:140px;color:#000000;opacity:100%;">
            Next
        </button>

        <button class="general-menu-button" @onclick="GoToChainUrl"
                style="position:absolute;left:400px;top:650px;height:60px;border:0px;width:140px;color:#000000;opacity:100%;">
            Chain
        </button>

    </div>

    


    <!-- Navigation Buttons -->
    <div class="navigation">
        <button @onclick="GoToPreviousUrl">Previous</button>
        <button @onclick="GoToNextUrl">Next</button>
        <button @onclick="GoToChainUrl">Chain</button>
    </div>

    <select @onchange="OnPriorityFilterChanged">
        <option value="">All Priorities</option>
        @foreach (var level in priorityLevels)
        {
            <option value="@level">Level @level</option>
        }
    </select>
    
    <select @onchange="OnUrlTypeFilterChanged">
        <option value="All">All Types</option>
        @foreach (var type in urlTypes)
        {
            <option value="@type">@type</option>
        }
    </select>

    <input type="text" @bind="tagFilter" @oninput="OnTagFilterChanged" placeholder="Filter by Tag" />
}

